<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Modules &#8212; openbiomaps 2.2 documentation</title>
    
    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '2.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="search" title="Search" href="search.html" />
    <link rel="top" title="openbiomaps 2.2 documentation" href="index.html" />
    <link rel="next" title="Virtual server" href="gekko_install.html" />
    <link rel="prev" title="Administrative pages" href="admin_pages.html" /> 
  </head>
  <body role="document">
    <table style='background-color:#eeeeee;padding:10px;margin:0;width:100%'>
    <tr>
        <td style='vertical-align:bottom'>
            <a href='http://openbiomaps.org' style='border:0'><img src="_images/OpenBioMaps.png"></a>
        </td>
        <td style='vertical-align:top;text-align:right'>
            <a href='http://openbiomaps.org' target='_blank'>Home</a> | <a href='http://openbiomaps.org/community/' target='_blank'>Community</a> | <a href='faq.html'>FAQ</a> | <a href='https://twitter.com/OpenBioMaps' target='_blank'>Twitter</a> | <a href="https://github.com/OpenBioMaps/documentation/tree/master/official_docs" class="fa fa-github"> Edit on GitHub</a>
        </td>
    </tr>
    </table>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="gekko_install.html" title="Virtual server"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="admin_pages.html" title="Administrative pages"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">openbiomaps 2.2 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="modules">
<h1>Modules<a class="headerlink" href="#modules" title="Permalink to this headline">¶</a></h1>
<div class="section" id="additional-columns">
<h2>additional_columns<a class="headerlink" href="#additional-columns" title="Permalink to this headline">¶</a></h2>
<div class="highlight-guess"><div class="highlight"><pre>Additional columns

Calls:

Functions: return_columns()

General description:
    use it together with the join_tables module
    return with an array:
    co [0] columns array
    c  [1] column name assoc array

Parameters:
</pre></div>
</div>
</div>
<div class="section" id="allowed-columns">
<h2>allowed_columns<a class="headerlink" href="#allowed-columns" title="Permalink to this headline">¶</a></h2>
<div class="highlight-guess"><div class="highlight"><pre>Columns visibility for users in different access levels
It depends on the existence of _rules table

Calls:

Functions:
   return_columns(), return_gcolumns()

General description:

Parameters:
   for_sensitive_data: comma separated list of column names
   for_no-geom_data: comma separated list of column names
   for_general: comma separated list of column names
</pre></div>
</div>
</div>
<div class="section" id="bold-yellow">
<h2>bold_yellow<a class="headerlink" href="#bold-yellow" title="Permalink to this headline">¶</a></h2>
<div class="highlight-guess"><div class="highlight"><pre>Bold yellow text for some columns in the results lists.

Calls:

General description:

Parameters:
  column names
</pre></div>
</div>
</div>
<div class="section" id="box-load-selection">
<h2>box_load_selection<a class="headerlink" href="#box-load-selection" title="Permalink to this headline">¶</a></h2>
<div class="highlight-guess"><div class="highlight"><pre><span class="nx">Map</span> <span class="nx">filter</span> <span class="nx">functions</span>

<span class="nx">These</span> <span class="nx">functions</span> <span class="nx">returns</span> <span class="kd">with</span> <span class="nx">a</span> <span class="nx">html</span> <span class="nx">table</span> <span class="nx">which</span> <span class="nx">displayed</span> <span class="nx">beside</span> <span class="nx">the</span> <span class="nx">map</span> <span class="nb">window</span>
<span class="nx">These</span> <span class="nx">are</span> <span class="nx">optional</span> <span class="nx">boxes</span><span class="p">.</span> <span class="nx">Setting</span> <span class="nx">are</span> <span class="k">in</span> <span class="nx">the</span> <span class="nx">biomaps</span> <span class="nx">db</span> <span class="nx">projects</span><span class="s1">&#39; table.</span>

<span class="s1">Load prevously saved spatial queries&#39;</span> <span class="nx">polygons</span>

<span class="nx">Calls</span><span class="o">:</span>

<span class="nx">General</span> <span class="nx">description</span><span class="o">:</span>

<span class="nx">Parameters</span><span class="o">:</span>
</pre></div>
</div>
</div>
<div class="section" id="box-load-coord">
<h2>box_load_coord<a class="headerlink" href="#box-load-coord" title="Permalink to this headline">¶</a></h2>
<div class="highlight-guess"><div class="highlight"><pre>Show given coordinates position on the map

Calls: print_box, limits, ajax, print_js

General description:

Parameters:
</pre></div>
</div>
</div>
<div class="section" id="box-load-last-data">
<h2>box_load_last_data<a class="headerlink" href="#box-load-last-data" title="Permalink to this headline">¶</a></h2>
<div class="highlight-guess"><div class="highlight"><pre>Query last data or last uploads.

Calls:

General description:

Parameters:
</pre></div>
</div>
</div>
<div class="section" id="box-custom">
<h2>box_custom<a class="headerlink" href="#box-custom" title="Permalink to this headline">¶</a></h2>
<div class="highlight-guess"><div class="highlight"><pre>Custom box - only user defined version exists.

Calls:

General description:

Parameters:
</pre></div>
</div>
</div>
<div class="section" id="photos">
<h2>photos<a class="headerlink" href="#photos" title="Permalink to this headline">¶</a></h2>
<div class="highlight-guess"><div class="highlight"><pre>Photo or other attachment box.

Calls:

General description:

Parameters:
</pre></div>
</div>
</div>
<div class="section" id="results-summary">
<h2>results_summary<a class="headerlink" href="#results-summary" title="Permalink to this headline">¶</a></h2>
<div class="highlight-guess"><div class="highlight"><pre>Summary of results.
</pre></div>
</div>
</div>
<div class="section" id="results-table">
<h2>results_table<a class="headerlink" href="#results-table" title="Permalink to this headline">¶</a></h2>
<div class="highlight-guess"><div class="highlight"><pre>Create a full html table of the results.

Calls:

General description:
    Not used!!

Parameters:
</pre></div>
</div>
</div>
<div class="section" id="results-aslist">
<h2>results_asList<a class="headerlink" href="#results-aslist" title="Permalink to this headline">¶</a></h2>
<div class="highlight-guess"><div class="highlight"><pre>Create foldable slides like results.

Calls: results_builder()

General description:

Parameters:
</pre></div>
</div>
</div>
<div class="section" id="results-asgpx">
<h2>results_asGPX<a class="headerlink" href="#results-asgpx" title="Permalink to this headline">¶</a></h2>
<div class="highlight-guess"><div class="highlight"><pre>Save results as a GPX file.

Calls:

General description:

Parameters:
</pre></div>
</div>
</div>
<div class="section" id="results-ascsv">
<h2>results_asCSV<a class="headerlink" href="#results-ascsv" title="Permalink to this headline">¶</a></h2>
<div class="highlight-guess"><div class="highlight"><pre>Save results as a csv file.

Hívások:

Általános leírás:

Paraméterek:
</pre></div>
</div>
</div>
<div class="section" id="results-asjson">
<h2>results_asJSON<a class="headerlink" href="#results-asjson" title="Permalink to this headline">¶</a></h2>
<div class="highlight-guess"><div class="highlight"><pre>Save results as a JSON file.

Calls:

General description:

Parameters:
</pre></div>
</div>
</div>
<div class="section" id="results-asshp">
<h2>results_asSHP<a class="headerlink" href="#results-asshp" title="Permalink to this headline">¶</a></h2>
<div class="highlight-guess"><div class="highlight"><pre>Save results as a shp file.

Calls:

General description:

Parameters:
</pre></div>
</div>
</div>
<div class="section" id="results-buttons">
<h2>results_buttons<a class="headerlink" href="#results-buttons" title="Permalink to this headline">¶</a></h2>
<div class="highlight-guess"><div class="highlight"><pre>Save and other button above results section, under map.

Calls:

General description:

Parameters:
</pre></div>
</div>
</div>
<div class="section" id="results-asstable">
<h2>results_asStable<a class="headerlink" href="#results-asstable" title="Permalink to this headline">¶</a></h2>
<div class="highlight-guess"><div class="highlight"><pre>Compact results table Stable.

Calls:

General description:

Parameters:
</pre></div>
</div>
</div>
<div class="section" id="specieslist">
<h2>specieslist<a class="headerlink" href="#specieslist" title="Permalink to this headline">¶</a></h2>
<div class="highlight-guess"><div class="highlight"><pre>Specieslist summary above results.

Calls:

General description:

Parameters:
</pre></div>
</div>
</div>
<div class="section" id="text-filter">
<h2>text_filter<a class="headerlink" href="#text-filter" title="Permalink to this headline">¶</a></h2>
<div class="highlight-guess"><div class="highlight"><pre>Taxon and other text filters.

Calls:

General description:
    create boxes
    assemble WHERE part of query string

Parameters:
</pre></div>
</div>
</div>
<div class="section" id="transform-data">
<h2>transform_data<a class="headerlink" href="#transform-data" title="Permalink to this headline">¶</a></h2>
<div class="highlight-guess"><div class="highlight"><pre>Transform data

Calls:

General description:
    In result list it transform data as need
    E.g. geometry to wkt

Parameters:
</pre></div>
</div>
</div>
<div class="section" id="extra-params">
<h2>extra_params<a class="headerlink" href="#extra-params" title="Permalink to this headline">¶</a></h2>
<div class="highlight-guess"><div class="highlight"><pre>Extra input paramaters for forms.

Calls:

General description:

Parameters:
</pre></div>
</div>
</div>
<div class="section" id="join-tables">
<h2>join_tables<a class="headerlink" href="#join-tables" title="Permalink to this headline">¶</a></h2>
<div class="highlight-guess"><div class="highlight"><pre>Join table to use additional columns

Calls:

Functions: return_joins()

General description:
    use it together with the additional_columns module
    RETURN: join command and column list and visible names list
    [0] column name , separated list
    [1] prefixed column names array: all column which defined in the database columns
    [2] visible names array of array by JOIN

Parameters:
</pre></div>
</div>
</div>
<div class="section" id="snap-to-grid">
<h2>snap_to_grid<a class="headerlink" href="#snap-to-grid" title="Permalink to this headline">¶</a></h2>
<div class="highlight-guess"><div class="highlight"><pre>Project specified sanp to grid points on the map

Calls:

Functions: geom_column(), geom_column_join(), rules_join()

General description:
    not recommended to use!

Parameters:
</pre></div>
</div>
</div>
<div class="section" id="restricted-data">
<h2>restricted_data<a class="headerlink" href="#restricted-data" title="Permalink to this headline">¶</a></h2>
<div class="highlight-guess"><div class="highlight"><pre>Rule based data restriction

alls

Functions: rule_data()

General description:

Parameters:
</pre></div>
</div>
</div>
<div class="section" id="form-choose">
<h2>form_choose<a class="headerlink" href="#form-choose" title="Permalink to this headline">¶</a></h2>
<div class="highlight-guess"><div class="highlight"><pre>List of available forms.

Calls:

Functions: form_list()

General description:

Parameters:
</pre></div>
</div>
</div>
<div class="section" id="identify-point">
<h2>identify_point<a class="headerlink" href="#identify-point" title="Permalink to this headline">¶</a></h2>
<div class="highlight-guess"><div class="highlight"><pre>A tool for identify one or more data elements on the map

Calls:

Functions: return_data(), print_button()

General description:

Parameters:
    column names

    json object: shows a hyperlink.

        elements:

            type - obligatory, egyelőre csak a &quot;link&quot; érték működik

            href - obligatory - hivatkozás címe

            label - obligatory - a link/gomb szövege/cimkéje - többnyelvűséget támogatja

            class - optional - a linkhez rendelt osztályok

            id - optional - a linkhez rendelt azonosító

            target - optional - alapértelmezett &quot;_blank&quot;

            params - optional - a href elem paraméterei

        A href elemet a modul-paraméterek közt felsorolt oszlopok értékeivel paraméterezhetjük. lásd a példát:

        Példa:
        { &quot;type&quot;: &quot;link&quot;, &quot;href&quot;: &quot;//example.com?nest_id=%1%&amp;species=%2%&quot;, &quot;label&quot;: &quot;str_add_data&quot;, &quot;class&quot;: &quot;pure-button button-href&quot;, &quot;params&quot;: [&quot;obm_id&quot;,&quot;species&quot;] }

        A fenti példa a következő hiperlinket fogja generálni:

        &lt;a href=&quot;//example.com?nest_id=2898&amp;species=Brachyramphus perdix&quot; target=&quot;_blank&quot; id=&quot;&quot; class=&quot;pure-button button-href&quot;&gt;Adat hozzáadása&lt;/a&gt;

        A json-t egy sorosra kell tömöríteni!
</pre></div>
</div>
</div>
<div class="section" id="notify">
<h2>notify<a class="headerlink" href="#notify" title="Permalink to this headline">¶</a></h2>
<div class="highlight-guess"><div class="highlight"><pre>Creates custom postgres based notify events.

Calls:

Functions: listen(), unlisten(), notify(), email()

General description:

Parameters:
</pre></div>
</div>
</div>
<div class="section" id="custom-data-check">
<h2>custom_data_check<a class="headerlink" href="#custom-data-check" title="Permalink to this headline">¶</a></h2>
<div class="highlight-guess"><div class="highlight"><pre>Custom data checks of upload data.

Calls:

Functions: list(), check()

General description:

Parameters:
</pre></div>
</div>
</div>
<div class="section" id="custom-filetype">
<h2>custom_filetype<a class="headerlink" href="#custom-filetype" title="Permalink to this headline">¶</a></h2>
<div class="highlight-guess"><div class="highlight"><pre>Custom file preparation. E.g. observado style CSV

Calls:

Functions: option_list(), custom_read()

General description:

Parameters:
</pre></div>
</div>
</div>
<div class="section" id="create-postgres-user">
<h2>create_postgres_user<a class="headerlink" href="#create-postgres-user" title="Permalink to this headline">¶</a></h2>
<div class="highlight-guess"><div class="highlight"><pre>Create a restricted access postgres user

Calls:

Functions: create_pg_user(), show_button()

General description:
    By enabling the module (who has the right to use the module), users can create their own postgres user. This user can only read from the database.
    It can read all the data tables assigned to the project.
    It can only connect to a database from one client program at a time.
    After one year, Its access expires automatically.
    Users can renew their access at any time.

Parameters:
</pre></div>
</div>
</div>
<div class="section" id="custom-admin-pages">
<h2>custom_admin_pages<a class="headerlink" href="#custom-admin-pages" title="Permalink to this headline">¶</a></h2>
<div class="highlight-guess"><div class="highlight"><pre><span class="n">Calls</span><span class="o">:</span>

<span class="n">Functions</span><span class="o">:</span> <span class="n">no</span> <span class="n">functions</span><span class="o">.</span>

<span class="n">General</span> <span class="n">description</span><span class="o">:</span>

<span class="n">Parameters</span><span class="o">:</span>
</pre></div>
</div>
</div>
<div class="section" id="grid-view">
<h2>grid_view<a class="headerlink" href="#grid-view" title="Permalink to this headline">¶</a></h2>
<div class="highlight-guess"><div class="highlight"><pre><span class="nx">View</span> <span class="nx">data</span> <span class="nx">on</span> <span class="nx">selected</span> <span class="nx">polygon</span> <span class="nx">grid</span>

<span class="nx">Calls</span><span class="o">:</span>

<span class="nx">Functions</span><span class="o">:</span> <span class="nx">print_box</span><span class="p">(),</span> <span class="nx">default_grid_geom</span><span class="p">(),</span> <span class="nx">get_grid_layer</span><span class="p">()</span>

<span class="nx">General</span> <span class="nx">description</span><span class="o">:</span>

<span class="nx">Parameters</span><span class="o">:</span> <span class="nx">layer_options</span>

<span class="nx">Parameters</span> <span class="nx">example</span><span class="o">:</span> <span class="nx">layer_options</span><span class="o">:</span><span class="nx">kef_5</span> <span class="p">(</span><span class="nx">dinpi_grid</span><span class="p">),</span> <span class="nx">utm_2</span><span class="p">.</span><span class="mi">5</span> <span class="p">(</span><span class="nx">dinpi_grid</span><span class="p">),</span> <span class="nx">utm_10</span> <span class="p">(</span><span class="nx">dinpi_grid</span><span class="p">),</span> <span class="nx">utm_100</span> <span class="p">(</span><span class="nx">dinpi_grid</span><span class="p">),</span> <span class="nx">original</span> <span class="p">(</span><span class="nx">dinpi_points</span><span class="p">,</span><span class="nx">dinpi_grid</span><span class="p">),</span><span class="nx">etrs</span><span class="p">(</span><span class="nx">dinpi_grid</span><span class="p">)</span>

<span class="nx">Example</span> <span class="nx">trigger</span> <span class="kd">function</span><span class="o">:</span>

<span class="nx">Trigger</span> <span class="nx">on</span> <span class="nx">nnn_qgrids</span><span class="o">:</span>
</pre></div>
</div>
<div class="highlight-sql"><div class="highlight"><pre><span class="k">CREATE</span> <span class="k">TRIGGER</span> <span class="n">self_update</span> <span class="k">BEFORE</span> <span class="k">INSERT</span> <span class="k">OR</span> <span class="k">UPDATE</span> <span class="k">ON</span> <span class="n">dinpi_qgrids</span> <span class="k">FOR</span> <span class="k">EACH</span> <span class="k">ROW</span> <span class="k">EXECUTE</span> <span class="k">PROCEDURE</span> <span class="n">update_qgrids_geometries</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-guess"><div class="highlight"><pre>Trigger on nnn table:
</pre></div>
</div>
<div class="highlight-sql"><div class="highlight"><pre><span class="k">CREATE</span> <span class="k">TRIGGER</span> <span class="n">update_qgrids</span> <span class="k">AFTER</span> <span class="k">INSERT</span> <span class="k">OR</span> <span class="k">DELETE</span> <span class="k">OR</span> <span class="k">UPDATE</span> <span class="k">ON</span> <span class="n">dinpi</span> <span class="k">FOR</span> <span class="k">EACH</span> <span class="k">ROW</span> <span class="k">EXECUTE</span> <span class="k">PROCEDURE</span> <span class="n">grid_geometries</span><span class="p">()</span>
</pre></div>
</div>
<p>Function grid_geometries()</p>
<div class="highlight-sql"><div class="highlight"><pre><span class="k">BEGIN</span>
<span class="n">IF</span> <span class="n">tg_op</span> <span class="o">=</span> <span class="s1">&#39;INSERT&#39;</span> <span class="k">THEN</span>

    <span class="k">EXECUTE</span> <span class="n">format</span><span class="p">(</span><span class="s1">&#39;INSERT INTO %I_qgrids (row_id,original) SELECT %L,%L::geometry&#39;</span><span class="p">,</span><span class="n">TG_TABLE_NAME</span><span class="p">,</span><span class="k">NEW</span><span class="p">.</span><span class="n">obm_id</span><span class="p">,</span><span class="k">NEW</span><span class="p">.</span><span class="n">obm_geometry</span><span class="p">);</span>

<span class="k">RETURN</span> <span class="k">NEW</span><span class="p">;</span>
<span class="k">END</span> <span class="n">IF</span><span class="p">;</span>

<span class="n">IF</span> <span class="n">tg_op</span> <span class="o">=</span> <span class="s1">&#39;UPDATE&#39;</span> <span class="k">THEN</span>
    <span class="c1">-- create original at first</span>
    <span class="c1">--EXECUTE format(&#39;INSERT INTO %I_qgrids (row_id,original) SELECT %L,%L::geometry&#39;,TG_TABLE_NAME,NEW.obm_id,NEW.obm_geometry);</span>
    <span class="k">EXECUTE</span> <span class="n">format</span><span class="p">(</span><span class="s1">&#39;UPDATE %I_qgrids SET &quot;original&quot;=%L::geometry WHERE row_id=%L&#39;</span><span class="p">,</span> <span class="n">TG_TABLE_NAME</span><span class="p">,</span><span class="k">NEW</span><span class="p">.</span><span class="n">obm_geometry</span><span class="p">,</span><span class="k">NEW</span><span class="p">.</span><span class="n">obm_id</span><span class="p">);</span>

<span class="k">RETURN</span> <span class="k">NEW</span><span class="p">;</span>
<span class="k">END</span> <span class="n">IF</span><span class="p">;</span>

<span class="n">IF</span> <span class="n">tg_op</span> <span class="o">=</span> <span class="s1">&#39;DELETE&#39;</span> <span class="k">THEN</span>

    <span class="k">EXECUTE</span> <span class="n">format</span><span class="p">(</span><span class="s1">&#39;DELETE FROM %I_qgrids WHERE row_id=%L&#39;</span><span class="p">,</span><span class="n">TG_TABLE_NAME</span><span class="p">,</span><span class="k">OLD</span><span class="p">.</span><span class="n">obm_id</span><span class="p">);</span>

<span class="k">RETURN</span> <span class="k">OLD</span><span class="p">;</span>
<span class="k">END</span> <span class="n">IF</span><span class="p">;</span>

<span class="k">END</span><span class="p">;</span>
</pre></div>
</div>
<p>Function update_qgrids_geometries()</p>
<div class="highlight-sql"><div class="highlight"><pre><span class="k">BEGIN</span>
<span class="c1">-- Available shared grids tables: kef_5, kef_10, utm_2.5, utm_10, etrs</span>
<span class="c1">-- Required output grids e.g.: kef_10x10, utm_10x10, etrs, snap</span>

    <span class="k">EXECUTE</span> <span class="n">FORMAT</span><span class="p">(</span><span class="s1">&#39;SELECT st_transform(geometry,4326) FROM shared.&quot;kef_5x5&quot;     WHERE st_within(st_setsrid(%L::geometry,4326),st_transform(geometry,4326))&#39;</span><span class="p">,</span><span class="k">NEW</span><span class="p">.</span><span class="n">original</span><span class="p">)</span> <span class="k">INTO</span> <span class="k">NEW</span><span class="p">.</span><span class="ss">&quot;kef_5&quot;</span><span class="p">;</span>
    <span class="k">EXECUTE</span> <span class="n">FORMAT</span><span class="p">(</span><span class="s1">&#39;SELECT st_transform(geometry,4326) FROM shared.&quot;kef_10x10&quot;   WHERE st_within(st_setsrid(%L::geometry,4326),st_transform(geometry,4326))&#39;</span><span class="p">,</span><span class="k">NEW</span><span class="p">.</span><span class="n">original</span><span class="p">)</span> <span class="k">INTO</span> <span class="k">NEW</span><span class="p">.</span><span class="ss">&quot;kef_10&quot;</span><span class="p">;</span>
    <span class="k">EXECUTE</span> <span class="n">FORMAT</span><span class="p">(</span><span class="s1">&#39;SELECT st_transform(geometry,4326) FROM shared.&quot;utm_2.5x2.5&quot; WHERE st_within(st_setsrid(%L::geometry,4326),st_transform(geometry,4326))&#39;</span><span class="p">,</span><span class="k">NEW</span><span class="p">.</span><span class="n">original</span><span class="p">)</span> <span class="k">INTO</span> <span class="k">NEW</span><span class="p">.</span><span class="ss">&quot;utm_2.5&quot;</span><span class="p">;</span>
    <span class="k">EXECUTE</span> <span class="n">FORMAT</span><span class="p">(</span><span class="s1">&#39;SELECT st_transform(geometry,4326) FROM shared.&quot;utm_10x10&quot;   WHERE st_within(st_setsrid(%L::geometry,4326),st_transform(geometry,4326))&#39;</span><span class="p">,</span><span class="k">NEW</span><span class="p">.</span><span class="n">original</span><span class="p">)</span> <span class="k">INTO</span> <span class="k">NEW</span><span class="p">.</span><span class="ss">&quot;utm_10&quot;</span><span class="p">;</span>
    <span class="k">EXECUTE</span> <span class="n">FORMAT</span><span class="p">(</span><span class="s1">&#39;SELECT st_transform(geometry,4326) FROM shared.&quot;utm_100x100&quot; WHERE st_within(st_setsrid(%L::geometry,4326),st_transform(geometry,4326))&#39;</span><span class="p">,</span><span class="k">NEW</span><span class="p">.</span><span class="n">original</span><span class="p">)</span> <span class="k">INTO</span> <span class="k">NEW</span><span class="p">.</span><span class="ss">&quot;utm_100&quot;</span><span class="p">;</span>
    <span class="k">EXECUTE</span> <span class="n">FORMAT</span><span class="p">(</span><span class="s1">&#39;SELECT st_transform(geometry,4326) FROM shared.&quot;etrs&quot;        WHERE st_within(st_setsrid(%L::geometry,4326),st_transform(geometry,4326))&#39;</span><span class="p">,</span><span class="k">NEW</span><span class="p">.</span><span class="n">original</span><span class="p">)</span> <span class="k">INTO</span> <span class="k">NEW</span><span class="p">.</span><span class="ss">&quot;etrs&quot;</span><span class="p">;</span>
    <span class="k">EXECUTE</span> <span class="n">FORMAT</span><span class="p">(</span><span class="s1">&#39;SELECT st_SnapToGrid(%L::geometry,0.13,0.09)&#39;</span><span class="p">,</span><span class="k">NEW</span><span class="p">.</span><span class="n">original</span><span class="p">)</span> <span class="k">INTO</span> <span class="k">NEW</span><span class="p">.</span><span class="ss">&quot;snap&quot;</span><span class="p">;</span>

    <span class="k">RETURN</span> <span class="k">NEW</span><span class="p">;</span>

<span class="k">END</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Modules</a><ul>
<li><a class="reference internal" href="#additional-columns">additional_columns</a></li>
<li><a class="reference internal" href="#allowed-columns">allowed_columns</a></li>
<li><a class="reference internal" href="#bold-yellow">bold_yellow</a></li>
<li><a class="reference internal" href="#box-load-selection">box_load_selection</a></li>
<li><a class="reference internal" href="#box-load-coord">box_load_coord</a></li>
<li><a class="reference internal" href="#box-load-last-data">box_load_last_data</a></li>
<li><a class="reference internal" href="#box-custom">box_custom</a></li>
<li><a class="reference internal" href="#photos">photos</a></li>
<li><a class="reference internal" href="#results-summary">results_summary</a></li>
<li><a class="reference internal" href="#results-table">results_table</a></li>
<li><a class="reference internal" href="#results-aslist">results_asList</a></li>
<li><a class="reference internal" href="#results-asgpx">results_asGPX</a></li>
<li><a class="reference internal" href="#results-ascsv">results_asCSV</a></li>
<li><a class="reference internal" href="#results-asjson">results_asJSON</a></li>
<li><a class="reference internal" href="#results-asshp">results_asSHP</a></li>
<li><a class="reference internal" href="#results-buttons">results_buttons</a></li>
<li><a class="reference internal" href="#results-asstable">results_asStable</a></li>
<li><a class="reference internal" href="#specieslist">specieslist</a></li>
<li><a class="reference internal" href="#text-filter">text_filter</a></li>
<li><a class="reference internal" href="#transform-data">transform_data</a></li>
<li><a class="reference internal" href="#extra-params">extra_params</a></li>
<li><a class="reference internal" href="#join-tables">join_tables</a></li>
<li><a class="reference internal" href="#snap-to-grid">snap_to_grid</a></li>
<li><a class="reference internal" href="#restricted-data">restricted_data</a></li>
<li><a class="reference internal" href="#form-choose">form_choose</a></li>
<li><a class="reference internal" href="#identify-point">identify_point</a></li>
<li><a class="reference internal" href="#notify">notify</a></li>
<li><a class="reference internal" href="#custom-data-check">custom_data_check</a></li>
<li><a class="reference internal" href="#custom-filetype">custom_filetype</a></li>
<li><a class="reference internal" href="#create-postgres-user">create_postgres_user</a></li>
<li><a class="reference internal" href="#custom-admin-pages">custom_admin_pages</a></li>
<li><a class="reference internal" href="#grid-view">grid_view</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="admin_pages.html"
                        title="previous chapter">Administrative pages</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="gekko_install.html"
                        title="next chapter">Virtual server</a></p>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="gekko_install.html" title="Virtual server"
             >next</a></li>
        <li class="right" >
          <a href="admin_pages.html" title="Administrative pages"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">openbiomaps 2.2 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright OpenBioMaps Consortium 2015 - 2018.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.9.
    </div>
  </body>
</html>