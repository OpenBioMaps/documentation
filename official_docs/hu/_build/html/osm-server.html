
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>&lt;no title&gt; &#8212; openbiomaps 4.0 documentation</title>
    <link rel="stylesheet" href="_static/agogo.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <link rel="search" title="Search" href="search.html" /> 
  </head><body>
    <table style='background-color:#eeeeee;padding:10px;margin:0;width:100%'>
    <tr>
        <td rowspan='2' style='vertical-align:bottom'>
            <a href='http://openbiomaps.org' style='border:0'><img src="_images/OpenBioMaps.png"></a>
        </td>
        <td style='vertical-align:top;text-align:right'>
            <a href='http://openbiomaps.org' target='_blank'>Kezdőlap</a> | 
            <a href='http://openbiomaps.org/community/' target='_blank'>Közösség</a> | 
            <a href='faq.html'>GYIK</a> | 
            <a href='https://gitlab.com/groups/openbiomaps/-/issues'>Ügyek</a> | 
            <a href='https://twitter.com/OpenBioMaps' target='_blank'>Twitter</a> | 
            <a href="https://github.com/OpenBioMaps/documentation/tree/master/official_docs" class="fa fa-github">Dokumentáció szerkesztése</a>
        </td>
    </tr>
    <tr>
         <td style="padding: 0px 10px 0px 0px; text-align: right; vertical-align: bottom;">
          <a href="http://openbiomaps.org/documents/en/"><img src="_static/flagicons/en.png" alt="en" title="in English" border="0" /></a>
          <a href="http://openbiomaps.org/documents/hu/"><img src="_static/flagicons/hu.png" alt="hu" title="Magyarul" border="0" /></a>
         </td>
    </tr>
    </table>

    <div class="content-wrapper">
      <div class="content">
        <div class="document">
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <p>Openstreetmap szerver létrehozása</p>
<p>Ahhoz, hogy az OBM mobilalkalmazás az OpenStreetMap alaptérképhez offline hozzáférhessen, az OBM közösségnek saját openstreetmap szolgáltató hálózatot kell létrehoznia.
Erre azért van szükség, mert az openstreetmap szervereket rendkívül leterhelné az egyidejű, nagy mennyiségű csempeletöltés, ezért ezt a lehetőséget nem teszik lehetővé a kliensek számára.
Saját OSM szerverekkel azonban kikerülhető ez a probléma.</p>
<ol class="arabic simple">
<li>Előkészítés</li>
</ol>
<p>A szerver létrehozása docker környezetben gyorsan és egyszerűen kivitelezhető.</p>
<p>1.1. A docker telepítése</p>
<p>Számos szerveren már telepítve van a docker.
A docker -v parancs segítségével megtudhatjuk, milyen verzió fut a szerveren.
Ha hibaüzenetet kapunk, akkor szükség van a docker beállítására.</p>
<p>Debian 9 esetében kövessük az alábbi linken található leírást.</p>
<p><a class="reference external" href="https://www.digitalocean.com/community/tutorials/how-to-install-and-use-docker-on-debian-9">https://www.digitalocean.com/community/tutorials/how-to-install-and-use-docker-on-debian-9</a></p>
<p>1.2. A docker munkakönyvtár áthelyezése</p>
<p>Alapértelmezetten a docker a a konténereket és köteteket a /var/lib mappában tárolja, ezért, különösen, ha az adott partíción kevés tárhelyünk van, célszerű a minkakönyvtárát megváltoztani, és ezeket áthelyezni.</p>
<p>Ehhez segítséget nyújthat az alábbi bejegyzés</p>
<p><a class="reference external" href="https://blog.adriel.co.nz/2018/01/25/change-docker-data-directory-in-debian-jessie/">https://blog.adriel.co.nz/2018/01/25/change-docker-data-directory-in-debian-jessie/</a></p>
<ol class="arabic simple" start="2">
<li>Az openstreetmap szerver telepítése (<a class="reference external" href="https://hub.docker.com/r/overv/openstreetmap-tile-server/">https://hub.docker.com/r/overv/openstreetmap-tile-server/</a> alapján)</li>
</ol>
<p>2.1. Docker Pull parancs</p>
<p>Az alábbi paranccsal tölthetjük le a szervert:</p>
<p>docker pull overv/openstreetmap-tile-server</p>
<p>2.2 Létre kell hozni egy kötetet az alábbi paranccsal:</p>
<p>docker volume create openstreetmap-data</p>
<p>2.3. Le kell tölteni egy .osm.pbf fájlt, amely tartalmazza a számunkra érdekes terület állományait. Ilyen adatokhoz férünk hozzá például a download.geofabrik.de weboldalon.
Magyarországot például az alábbi linken érhetjük el: <a class="reference external" href="http://download.geofabrik.de/europe/hungary.html">http://download.geofabrik.de/europe/hungary.html</a>. A szükséges állomány pedig a <a class="reference external" href="http://download.geofabrik.de/europe/hungary-latest.osm.pbf">http://download.geofabrik.de/europe/hungary-latest.osm.pbf</a> linken található.</p>
<p>Az adatállomány mellett a szolgáltatott terület határát is megadhatjuk a szervernek, így az adatállomány automatikus frissítési is lehetővé válik.</p>
<p>Ehhez a fenti példa alapján a <a class="reference external" href="http://download.geofabrik.de/europe/hungary.poly">http://download.geofabrik.de/europe/hungary.poly</a></p>
<p>A letöltött állományokat importálni kell a szerver PotgreSQL adatbázisába:</p>
<p>docker run -v /path/to/hungary-latest.osm.pbf:/data.osm.pbf -v /path/to/hungary.poly:/data.poly -v openstreetmap-data:/var/lib/postgresql/12/main overv/openstreetmap-tile-server import</p>
<p>Ha a konténer hibaüzenet nélkül kilép, akkor az állomány importálása sikeresen megtörtént (Magyarország esetében is eltarthat akár 10-15 percig is az import.</p>
<ol class="arabic simple" start="3">
<li>A szerver futtatása.</li>
</ol>
<p>A kiszolgáló a csempéket az első megjelenítés során rendereli, amely ilyenkor lassabb megjelenítést eredményez. Annak érdekében, hogy a csempék egy esetleges újraindítást követően is megmaradjanak, egy önálló köteten kell elhelyezni, az alábbi parancs kiadásával:</p>
<p>docker volume create openstreetmap-rendered-tiles</p>
<p>A későbbiekben az indítás során adjuk meg a csempék mentésének helyét a szervernek.</p>
<p>Ha olyan szerverre telepítjük, ahol már fut egy webkiszolgáló (például az OBM szerver), akkor másik portra kell irányítanunk a konténert.</p>
<p>Az automatikus frissítéseket is az indítás során engedélyezzük.</p>
<p>A fentiek alapján a szervert az alábbi parancs segítségével futassuk:</p>
<p>docker run -p 83:80 -e UPDATES=enabled -v openstreetmap-data:/var/lib/postgresql/12/main -v openstreetmap-rendered-tiles:/var/lib/mod_tile -d overv/openstreetmap-tile-server run</p>
<p>Így a 83-as portot használja majd kifelé az osm szerverünk, az elérési út tehát az alábbi lesz: myserver:83. Pl. obm.bnpi.hu:83</p>
<p>A böngészőben a világtérképet látjuk majd, ahonnan a megfelelő területre nagyítva jelenthetjük meg a csempéinket.</p>


          </div>
        </div>
      </div>
        </div>
        <div class="sidebar">
          <h3>Table of Contents</h3>
          <ul>
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Bevezetés</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">Oktató anyagok</a></li>
<li class="toctree-l1"><a class="reference internal" href="user_interface.html">Felhasználói felületek</a></li>
<li class="toctree-l1"><a class="reference internal" href="profile.html">Profil lap</a></li>
<li class="toctree-l1"><a class="reference internal" href="upload_data.html">Adatfeltöltés munkafolyamat</a></li>
<li class="toctree-l1"><a class="reference internal" href="admin_pages.html">Adminisztratív oldalak</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules.html">Modulok</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API dokumentáció</a></li>
<li class="toctree-l1"><a class="reference internal" href="server_install.html">Szerver telepítés lépései</a></li>
<li class="toctree-l1"><a class="reference internal" href="privacy.html">Adatkezelési irányelvek</a></li>
<li class="toctree-l1"><a class="reference internal" href="terms.html">Terms and condition</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">Gyakran Ismételt Kérdések</a></li>
</ul>

          <div role="search">
            <h3 style="margin-top: 1.5em;">Search</h3>
            <form class="search" action="search.html" method="get">
                <input type="text" name="q" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
            </form>
          </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

    <div class="footer-wrapper">
      <div class="footer">
        <div class="left">
          <div role="navigation" aria-label="related navigaton">
          </div>
          <div role="note" aria-label="source link">
          </div>
        </div>

        <div class="right">
          
    <div class="footer" role="contentinfo">
        &#169; Copyright OpenBioMaps Konzorcium 2015 - 2020.
      Last updated on Mar 15, 2020.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.4.
    </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

  </body>
</html>